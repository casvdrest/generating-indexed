open import Data.Unit
open import Data.Product
open import Data.Sum
open import Data.Nat
open import Data.Bool

module AgdaGen.Indexed.IDesc where

  data IDesc (i : Set) : Setâ‚ where
    var  : (x : i) â†’ IDesc i
    unit : IDesc i
    _Ã—áµ¢_ : IDesc i â†’ IDesc i â†’ IDesc i
    Î£áµ¢    : (s : Set) â†’ (s â†’ IDesc i) â†’ IDesc i
    Î áµ¢    : (s : Set) â†’ (s â†’ IDesc i) â†’ IDesc i

  âŸ¦_âŸ§ : âˆ€ {i : Set} â†’ IDesc i â†’ (i â†’ Set) â†’ Set
  âŸ¦ var x  âŸ§ r = r x
  âŸ¦ unit   âŸ§ r = âŠ¤
  âŸ¦ a Ã—áµ¢ b âŸ§ r = âŸ¦ a âŸ§ r Ã— âŸ¦ b âŸ§ r 
  âŸ¦ Î£áµ¢ s P âŸ§ r = (x : s) â†’ âŸ¦ P x âŸ§ r
  âŸ¦ Î áµ¢ s P âŸ§ r = Î£[ x âˆˆ s ] âŸ¦ P x âŸ§ r
  
  func : Set â†’ Set â†’ Setâ‚
  func i j = j â†’ IDesc i

  âŸ¦_âŸ§ğ”£ : âˆ€ {i j : Set} â†’ func i j â†’ (i â†’ Set) â†’ j â†’ Set
  âŸ¦ d âŸ§ğ”£ r = Î» j â†’ âŸ¦ d j âŸ§ r

  VecD : Set â†’ func â„• â„•
  VecD a zero = unit
  VecD a (suc n) = Î£áµ¢ a Î» _ â†’ var n Ã—áµ¢ unit

  data Fix {i : Set} (d : func i i) : i â†’ Set where
    In : âˆ€ {x : i} â†’ âŸ¦ d âŸ§ğ”£ (Fix d) x â†’ Fix d x

  data Ty : Set where
    `nat  : Ty
    `bool : Ty

  Val : Ty â†’ Set
  Val `nat = â„•
  Val `bool = Bool

  _<=_ : â„• â†’ â„• â†’ Bool
  zero <= m = true
  suc n <= zero = false
  suc n <= suc m = n <= m

  
